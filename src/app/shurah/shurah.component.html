<div *ngIf="rootOrganisation!=null">
  <h2>
    Shurah 
  </h2>
  <p *ngIf="rootOrganisation.member==null && auth.authenticated()">
  	To use the shurah tools, please agree to the following rules:
  </p>
  <h3> {{rootOrganisation.name}} rules</h3>
  <span *ngIf=" auth.authenticated() && allow('EditMembershipRules')">
      <button (click)="open(addSectionModal)">+ Section</button>
   </span>
  <ol>
  <li *ngFor="let section of rootOrganisation.ruleSections" [id]="section.uniqueName">
    <sub-section (addSection)="open(addSectionModal,$event)" [section]="section" [sub-sections]="section.subSections" [allow-edit]=" auth.authenticated() && allow('EditMembershipRules')"></sub-section>
  </li>
  </ol>
  <div *ngIf="rootOrganisation.ruleSections.length==0">
  	<p>No rules have been set for this organisation</p>
  </div>
  <p *ngIf="rootOrganisation.member==null && auth.authenticated() && !hideButtons">
  	I agree to hold to the rules of this organisation and to become a member.
  	<button (click)="join()"> Join </button>
  </p>
  <p *ngIf="rootOrganisation.member!=null && auth.authenticated() && !hideButtons">

  	I no longer agree to hold to the rules of this organisation and want to stop being a member.
  	<button (click)="leave()"> Leave </button>
  </p>
</div>

<template #addSectionModal let-c="close" let-d="dismiss">
   <form>
  <div class="modal-header">
    <h4 class="modal-title">Add Membership Rules Section
    <span *ngIf="addSectionModel.parentSection!=null">
      within "{{addSectionModel.parentSection.title}}"
    </span>
    </h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
      <label for="sectionName">Section Name</label>
      <input type="text" [(ngModel)]="addSectionModel.name" required maxlength="100" id="name" name="name">
      <div>
        Url Id: {{addSectionModel.urlSlug()}}
      </div>
    <ul>
      <li class="error" *ngFor="let error of errors">
        {{error}}
      </li>
    </ul>
  </div>
  <div class="modal-footer">
    <button type="submit" class="btn btn-primary" (click)="beginAddRuleSection()">Add</button>

    <button type="button" class="btn btn-secondary" (click)="c('Close click')">Close</button>
  </div>
    </form>

</template>

